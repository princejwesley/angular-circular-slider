/*!The MIT License (MIT)

Copyright (c) 2015 Prince John Wesley (princejohnwesley@gmail.com)
**/
!function(a,b,c){function d(a){return(0|a)===a}function e(){return!0}function f(c){function d(a){return function(){return o[a]}}function e(a){return n[a]}function g(a){return function(){return e(a)}}function h(a){return parseFloat(a)||0}function i(a,b){return function(){return h(a())+h(b())}}function j(a){return function(b){return h(a(b))}}function k(){return b.element(n.offsetParent)}function l(){var a=n.getBoundingClientRect(),b=n.ownerDocument.documentElement;return{top:a.top+b.scrollTop-b.clientTop,left:a.left+b.scrollLeft-b.clientLeft}}function m(){var a=f(k()),b=a.offset(),d=l();return b.top+=h(a.css("borderTopWidth")),b.left+=h(a.css("borderLeftWidth")),{top:d.top-b.top-h(c.css("marginTop")),left:d.left-b.left-h(c.css("marginLeft"))}}var n=c[0],o=a.getComputedStyle(n,null);return{css:c.css,prop:e,width:j(d("width")),height:j(d("height")),outerWidth:i(i(g("offsetWidth"),d("marginLeft")),d("marginRight")),outerHeight:i(i(g("offsetHeight"),d("marginTop")),d("marginBottom")),innerWidth:i(i(d("width"),d("paddingLeft")),d("paddingRight")),innerHeight:i(i(d("height"),d("paddingTop")),d("paddingBottom")),offset:l,offsetParent:k,position:m}}function g(){function a(a,c,d,e,g){function h(){var d=p(),e=q();k[a.shape].drawShape(d,e),o(d,e);var g=f(d.acs),h=f(d.acsIndicator);i.acsPosition=g.position(),i.acsRadius=g.width()/2,i.acsBallRadius=h.width()/2,i.acsCenter=k[a.shape].getCenter(i.acsPosition,i.acsRadius),a.selectable?d.acsPanel.removeClass("noselect"):d.acsPanel.addClass("noselect"),a.touch&&m(),b.forEach(["mouseup","mousedown","mousemove","mouseleave","click"],function(a){c.on(a,l[a])}),n(a.value||a.min)}function m(){b.forEach(["touchstart","touchmove","touchend","touchcancel"],function(a){c.on(a,l.touch)})}function n(b){e.validateBinding("value");var c=a.clockwise?b:a.max-b,d=k[a.shape].val2Deg(c),f=d*Math.PI/180,g=p(),h=g.scope.borderWidth+i.acsBallRadius,j=i.acsCenter.x+i.acsCenter.r*a.handleDistRatio*Math.cos(f)-h,l=i.acsCenter.y+i.acsCenter.r*a.handleDistRatio*Math.sin(f)-h;g.acsIndicator.css("top",l+"px"),g.acsIndicator.css("left",j+"px"),a.value=a.$$value=b,"function"==typeof a.onSlide&&a.onSlide()}function o(b,c){b.acsIndicator.css({width:c*a.indicatorBallRatio+"px",height:c*a.indicatorBallRatio+"px"})}function p(){var d=c.children(),f=d.children(),g=b.element(f[0]),h=b.element(f[1]),j=g.children(),k={acsPanel:d,acs:g,acsIndicator:h,acsValue:j,scope:a,ctrl:e};return i.components=k}function q(){return Math.abs(parseInt(a.radius))||j.defaults.radius}b.isUndefined(a.value)&&(a.value=a.min),b.forEach(a.$$isolateBindings,function(c,d){b.isUndefined(a[d])&&(a[d]=j.defaults[d])}),e.validateBindings(),c.addClass("acs-slider"),h(),i.funs={setValue:n},g(a,function(a){b.element(c[0].getElementsByClassName("acs-value")).empty().append(a)}),a.$watch("value",function(b){if(!i.components.scope.disabled&&b!==a.$$value)try{i.funs.setValue(b)}catch(c){throw a.value=a.$$value,c}})}return{template:j.template,restrict:"EA",transclude:!0,controller:h,controllerAs:"slider",scope:{min:"=?",max:"=?",value:"=?",radius:"=?",innerCircleRatio:"=?",indicatorBallRatio:"=?",handleDistRatio:"=?",borderWidth:"=?",clockwise:"=?",shape:"@?",touch:"=?",animate:"=?",animateDuration:"=?",selectable:"=?",disabled:"=?",onSlide:"&",onSlideEnd:"&"},link:a}}function h(a){function c(a){return function(b,c){return[b,"(",c,") - Expected",a].join(" ")}}function f(a){b.forEach(i,function(c,d){b.forEach(c,function(b,c){var d=b.bindings;d.map(function(c){a[c]=a[c]||{tests:[]},a[c].tests.push({test:b.test,onError:b.onError})})})}),b.forEach(h,function(c){b.forEach(c.bindings,function(b){a[b].transform=c.transform})})}var g=["Circle","Half Circle","Half Circle Left","Half Circle Right","Half Circle Bottom"],h={integer:{bindings:["min","max","value","radius","animateDuration","borderWidth"],transform:parseInt},number:{bindings:["innerCircleRatio","indicatorBallRatio","handleDistRatio"],transform:parseFloat},"boolean":{bindings:["touch","animate","selectable","clockwise","disabled"],transform:function(a){return"true"===a||a===!0}},"function":{bindings:["onSlide","onSlideEnd"],transform:function(a){return a?a:b.noop}}},i={type:{integer:{bindings:["min","max","value","radius","animateDuration","borderWidth"],test:d,onError:c("integer")},number:{bindings:["innerCircleRatio","indicatorBallRatio","handleDistRatio"],test:isFinite,onError:c("number")},"boolean":{bindings:["touch","animate","selectable","clockwise","disabled"],test:e,onError:c("boolean")},"function":{bindings:["onSlide","onSlideEnd"],test:b.isFunction,onError:c("function")}},constraint:{range:{bindings:["min","max"],test:function(){return a.min<=a.max},onError:function(){return["Invalid slide range: [",a.min,",",a.max,"]"].join("")}},value:{bindings:["value"],test:function(b){return a.min<=b&&b<=a.max},onError:function(){return[a.value,"(value) out of range: [",a.min,",",a.max,"]"].join("")}},shape:{bindings:["shape"],test:function(){return-1!==g.indexOf(a.shape)},onError:function(){return["Unsupported shape: ",a.shape].join("")}},ratio:{bindings:["innerCircleRatio","handleDistRatio","indicatorBallRatio"],test:function(a){return a>=0&&1>=a},onError:function(a,b){return[a+"(",b,") is out of range: [0,1]"].join("")}}}};this.validateBindings=function(b){var c,d=b?b:this.props;for(c in d)d[c].transform&&(a[c]=d[c].transform(a[c])),d[c].tests.forEach(function(b){if(!b.test(a[c]))throw b.onError(c,a[c])})},this.validateBinding=function(a){if(!b.isUndefined(a)){var c={};c[a]=this.props[a],this.validateBindings(c)}},f(this.props={})}var i={},j={defaults:{min:0,max:359,value:0,radius:75,innerCircleRatio:.5,borderWidth:1,indicatorBallRatio:.2,handleDistRatio:1,clockwise:!0,shape:"Circle",touch:!0,animate:!0,animateDuration:360,selectable:!1,disabled:!1,onSlide:b.noop,onSlideEnd:b.noop},template:'      <div class="acs-panel">        <div class="acs">          <div class="acs-value" ng-transclude>          </div>        </div>        <div class="acs-indicator">        </div>      </div>    '},k={Circle:{drawShape:function(a,b){var c=2*b,d=c+"px",e=a.acs,g=a.acsValue,h=a.acsPanel,i=a.scope,j=i.borderWidth;e.css({width:d,height:d,"border-radius":d,"border-width":j+"px"});var k=c+j;h.css({"border-width":j+"px","border-radius":k+"px"});var l=f(e),m=f(g),n=i.innerCircleRatio*b;g.css({width:2*n+"px",height:2*n+"px","font-size":n/2+"px"});var o=b-n;g.css({top:o-l.prop("clientTop")-m.prop("clientTop")+"px",left:o-l.prop("clientLeft")-m.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top+b,r:b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a+90)%360,Math.round(a*(c/360))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(360/c))-90)%360}},"Half Circle":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({width:c+"px",height:b+"px","border-radius":c+"px "+c+"px 0 0","border-bottom":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":j+"px "+j+"px 0 0","border-bottom":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top+b,r:b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a+180)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))-180)%360}},"Half Circle Left":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({height:c+"px",width:b+"px","border-radius":c+"px 0 0 "+c+"px","border-right":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":j+"px 0 0"+j+"px","border-right":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+2*b,y:a.top+2*b,r:2*b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a-90)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))+90)%360}},"Half Circle Right":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({height:c+"px",width:b+"px","border-radius":"0 "+c+"px "+c+"px 0","border-left":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":"0 "+j+"px"+j+"px 0","border-left":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({top:n-k.prop("clientTop")-l.prop("clientTop")+"px",right:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left,y:a.top+2*b,r:2*b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return a=(a+90)%360,Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return(Math.round(d*(180/c))-90)%360}},"Half Circle Bottom":{drawShape:function(a,b){var c=2*b,d=a.acs,e=a.acsValue,g=a.acsPanel,h=a.scope,i=h.borderWidth;d.css({width:c+"px",height:b+"px","border-radius":"0 0 "+c+"px "+c+"px","border-top":"none","border-width":i+"px"});var j=c+i;g.css({"border-width":i+"px","border-radius":"0 0 "+j+"px "+j+"px","border-top":"none"});var k=f(d),l=f(e),m=h.innerCircleRatio*b;e.css({width:2*m+"px",height:2*m+"px","font-size":m/2+"px"});var n=b-m;e.css({bottom:n-k.prop("clientTop")-l.prop("clientTop")+"px",left:n-k.prop("clientLeft")-l.prop("clientLeft")+"px"})},getCenter:function(a,b){return{x:a.left+b,y:a.top,r:b}},deg2Val:function(a){var b=i.components.scope,c=b.max-b.min+1;if(0>a||a>359)throw"Invalid angle "+a;return Math.round(a*(c/180))+b.min},val2Deg:function(a){var b=i.components.scope,c=b.max-b.min+1;if(a<b.min||a>b.max)throw"Invalid range "+a;var d=a-b.min;return Math.round(d*(180/c))}}},l=function(){function c(){var a=i.components.scope;"function"==typeof a.onSlideEnd&&a.onSlideEnd()}var d=!1,e=!1,g="",h=function(c){var d=c.changedTouches;if(!(d.length>1)){var e=d[0],h=b.element(e.target);if(h.hasClass("acs")){var i=f(h),j=i.offset(),k=i.width(),l=i.height(),m=e.clientX,n=e.clientY;if(!(m<j.left||m>k+j.left||n<j.top||n>l+j.top)){var o=["touchstart","touchmove","touchend","touchcancel"],p=["mousedown","mousemove","mouseup","mouseleave"],q=o.indexOf(c.type);if(-1!==q){var r=p[q];c.type===o[2]&&g===o[0]&&(r="click");var s=document.createEvent("MouseEvent");s.initMouseEvent(r,!0,!0,a,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(s),c.preventDefault(),g=c.type}}}}},j=function(b){var d={x:b.offsetX||b.layerX,y:b.offsetY||b.layerY},f=d.x-i.acsCenter.x,g=d.y-i.acsCenter.y,h=Math.atan2(g,f),j=180*h/Math.PI,l=parseInt(0>j?360+j:j)%360,m=i.components.scope,n=m.borderWidth+i.acsBallRadius,o=(i.acsCenter.x+i.acsCenter.r*m.handleDistRatio*Math.cos(h)-n,i.acsCenter.y+i.acsCenter.r*m.handleDistRatio*Math.sin(h)-n,(k[m.shape].val2Deg(m.value)+360)%360);if(o!==l){var p=Math.min((l+360-o)%360,(o+360-l)%360);p||(p=180);var q=(l+360-o)%360===p,r=m.animateDuration/p,s=4,t=1;r>=4?s=parseInt(r):t=r>=1?4*parseInt(r):4/r;var u=o,v=parseInt(p/t);e=!0;var w=function(){u+=q?t:-t,u=(u+360)%360,--v<=0&&(clearInterval(x),e=!1,u=l),i.funs.setValue(k[m.shape].deg2Val(u)),m.$apply(),e||c()},x=a.setInterval(w,s)}},l=function(a){if(a.stopPropagation(),d&&!e){var b={x:a.offsetX||a.layerX,y:a.offsetY||a.layerY},c=b.x-i.acsCenter.x,f=b.y-i.acsCenter.y,g=Math.atan2(f,c),h=180*g/Math.PI,j=parseInt(0>h?360+h:h)%360,l=i.components.scope,m=l.borderWidth+i.acsBallRadius,n=i.acsCenter.x+i.acsCenter.r*l.handleDistRatio*Math.cos(g)-m,o=i.acsCenter.y+i.acsCenter.r*l.handleDistRatio*Math.sin(g)-m;i.components.acsIndicator.css("top",o+"px"),i.components.acsIndicator.css("left",n+"px");var p=k[l.shape].deg2Val(j),q=l.clockwise?p:l.max-p;q<l.min?q=l.min:q>l.max&&(q=l.max),l.value=l.$$value=q,l.onSlide(),l.$apply()}},m=function(a){i.components.scope.disabled||(d=!0,a.stopPropagation())},n=function(a){i.components.scope.disabled||(d=!1,a.stopPropagation())},o=function(a){if(!i.components.scope.disabled){a.stopPropagation();var b={x:a.offsetX||a.layerX,y:a.offsetY||a.layerY},e=b.x-i.acsCenter.x,f=b.y-i.acsCenter.y,g=i.components.scope,h=Math.sqrt(e*e+f*f);i.acsRadius-h<=.1*i.acsRadius||h>i.acsRadius?g.animate?j(a):(d=!0,l(a),c()):c(),d=!1}};return{touch:h,mousemove:l,mousedown:m,mouseup:n,mouseleave:n,click:o}}();h.$inject=["$scope"],b.module("angular.circular-slider",[]).directive("circularSlider",g)}(window,window.angular);